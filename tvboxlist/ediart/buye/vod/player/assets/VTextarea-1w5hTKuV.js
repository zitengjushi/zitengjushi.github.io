import{j as e,p as a,ah as t,v as l,k as o,s as r,a1 as u,A as s,o as n,Y as i,Z as d,B as v,aH as c,d as p,M as f,F as x,m,ab as g,aN as h,D as w,E as b,aj as y,ar as V,ag as F,aO as S}from"./index-C3ajj0iU.js";import{u as N,b as C,V as k,d as H,e as I,f as P,g as B,m as R,h as z}from"./autofocus-CGxummZr.js";import{I as M}from"./loader-_1sodkhb.js";const j=a({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxHeight:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...z(),...R(),...B()},"VTextarea"),G=e()({name:"VTextarea",directives:{vIntersect:M},inheritAttrs:!1,props:j(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,"update:rows":e=>!0},setup(e,a){function B(){var e;ee.isSuppressing.value&&ee.update(),L.value!==document.activeElement&&(null==(e=L.value)||e.focus()),T.value||U()}function R(e){B(),D("click:control",e)}function z(e){D("mousedown:control",e)}function j(a){a.stopPropagation(),B(),V(()=>{O.value="",S(e["onClick:clear"],a)})}function G(a){var t;const l=a.target;if(!(null==(t=e.modelModifiers)?void 0:t.trim))return void(O.value=l.value);const o=l.value,r=l.selectionStart,u=l.selectionEnd;O.value=o,V(()=>{let e=0;o.trimStart().length===l.value.length&&(e=o.length-l.value.length),null!=r&&(l.selectionStart=r-e),null!=u&&(l.selectionEnd=u-e)})}function _(){V(()=>{if(!L.value)return;if(X.value.firefox)return void(Q.value=12);const{offsetWidth:e,clientWidth:a}=L.value;Q.value=Math.max(0,e-a)}),e.autoGrow&&V(()=>{if(!te.value||!J.value)return;const a=getComputedStyle(te.value),t=getComputedStyle(J.value.$el),l=parseFloat(a.getPropertyValue("--v-field-padding-top"))+parseFloat(a.getPropertyValue("--v-input-padding-top"))+parseFloat(a.getPropertyValue("--v-field-padding-bottom")),o=te.value.scrollHeight,r=parseFloat(a.lineHeight),u=Math.max(parseFloat(e.rows)*r+l,parseFloat(t.getPropertyValue("--v-input-control-height"))),s=F(o??0,u,e.maxHeight?parseFloat(e.maxHeight):parseFloat(e.maxRows)*r+l||1/0);le.value=Math.floor((s-l)/r),K.value=b(s)})}let{attrs:A,emit:D,slots:E}=a;const O=t(e,"modelValue"),{isFocused:T,focus:U,blur:W}=N(e),{onIntersect:Y}=P(e),Z=l(()=>"function"==typeof e.counterValue?e.counterValue(O.value):(""+(O.value||"")).length),$=l(()=>A.maxlength?A.maxlength:!e.counter||"number"!=typeof e.counter&&"string"!=typeof e.counter?void 0:e.counter),q=o(),J=o(),K=r(""),L=o(),Q=o(0),{platform:X}=u(),ee=C(e),ae=l(()=>e.persistentPlaceholder||T.value||e.active),te=o(),le=o(+e.rows),oe=l(()=>["plain","underlined"].includes(e.variant));let re;return s(()=>{e.autoGrow||(le.value=+e.rows)}),n(_),i(O,_),i(()=>e.rows,_),i(()=>e.maxHeight,_),i(()=>e.maxRows,_),i(()=>e.density,_),i(le,e=>{D("update:rows",e)}),i(te,e=>{e?(re=new ResizeObserver(_),re.observe(te.value)):null==re||re.disconnect()}),d(()=>{null==re||re.disconnect()}),v(()=>{const a=!!(E.counter||e.counter||e.counterValue),t=!(!a&&!E.details),[l,o]=c(A),{modelValue:r,...u}=k.filterProps(e),s={...H.filterProps(e),"onClick:clear":j};return p(k,m({ref:q,modelValue:O.value,"onUpdate:modelValue":e=>O.value=e,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":oe.value},e.class],style:[{"--v-textarea-max-height":e.maxHeight?b(e.maxHeight):void 0,"--v-textarea-scroll-bar-width":b(Q.value)},e.style]},l,u,{centerAffix:1===le.value&&!oe.value,focused:T.value}),{...E,default:a=>{let{id:t,isDisabled:l,isDirty:r,isReadonly:u,isValid:n,hasDetails:i}=a;return p(H,m({ref:J,style:{"--v-textarea-control-height":K.value},onClick:R,onMousedown:z,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},s,{id:t.value,active:ae.value||r.value,labelId:t.value+"-label",centerAffix:1===le.value&&!oe.value,dirty:r.value||e.dirty,disabled:l.value,focused:T.value,details:i.value,error:!1===n.value}),{...E,default:a=>{let{props:{class:r,...s},controlRef:n}=a;return f(x,null,[e.prefix&&f("span",{class:"v-text-field__prefix"},[e.prefix]),g(f("textarea",m({ref:e=>L.value=n.value=e,class:r,value:O.value,onInput:G,autofocus:e.autofocus,readonly:u.value,disabled:l.value,placeholder:e.placeholder,rows:e.rows,name:ee.fieldName.value,autocomplete:ee.fieldAutocomplete.value,onFocus:B,onBlur:W,"aria-labelledby":t.value+"-label"},s,o),null),[[M,{handler:Y},null,{once:!0}]]),e.autoGrow&&g(f("textarea",{class:w([r,"v-textarea__sizer"]),id:s.id+"-sizer","onUpdate:modelValue":e=>O.value=e,ref:te,readonly:!0,"aria-hidden":"true"},null),[[h,O.value]]),e.suffix&&f("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:t?t=>{var l;return f(x,null,[null==(l=E.details)?void 0:l.call(E,t),a&&f(x,null,[f("span",null,null),p(I,{active:e.persistentCounter||T.value,value:Z.value,max:$.value,disabled:e.disabled},E.counter)])])}:void 0})}),y({},q,J,L)}});export{G as V};
