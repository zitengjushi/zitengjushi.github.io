function e(a){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise((o,n)=>{a.isFile?a.file(e=>o([{file:e,path:t}]),n):a.isDirectory&&a.createReader().readEntries(async a=>{const n=[];for(const o of a)n.push(...await e(o,l(t,o)));o(n)})})}function l(e,l){return l.isDirectory?`${e}/${l.name}`:e}import{j as a,p as t,ax as o,z as n,B as i,M as u,C as r,D as s,aL as d,L as c,aP as v,v as p,s as m,ak as f,d as g,m as y,E as h,F as b,at as x,k,c as w,b as V,w as S,R as D,g as I,h as C,aQ as P,a5 as B,ah as _,aR as T,aS as A,Y as E,aH as j,aj as F,ar as R,aO as z,_ as O,f as U,af as G,a6 as H,aT as L,ap as $,aU as M,aV as N,a2 as q,aW as K,aX as Y,aY as W,A as Q,aZ as X,O as Z,a_ as J,a$ as ee,i as le}from"./index-C3ajj0iU.js";import{V as ae,b as te,a as oe}from"./VCard-DTBu3HW2.js";import{V as ne,b as ie}from"./VBtn-JKfmtoJ-.js";import{V as ue}from"./VDialog-BiBfv1Qk.js";import{c as re,b as se,d as de,u as ce,e as ve,p as pe,f as me,g as fe,h as ge,i as ye,j as he,k as be,l as xe,n as ke,o as we,q as Ve,r as Se,s as De,t as Ie,v as Ce,w as Pe,x as Be,y as _e,z as Te,A as Ae,B as Ee,C as je,D as Fe,E as Re,F as ze,G as Oe,H as Ue,V as Ge,I as He}from"./VDataTable-WwBRdQ7c.js";import{V as Le}from"./VIcon-DO7afe9J.js";import{V as $e,a as Me}from"./VToolbar-DIHQZaEw.js";import{u as Ne,V as qe,d as Ke,e as Ye,g as We,m as Qe,i as Xe,j as Ze}from"./autofocus-CGxummZr.js";import{_ as Je}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{V as el,m as ll}from"./VTextField-CT2tUTqH.js";import{u as al,t as tl,V as ol,a as nl,b as il,d as ul}from"./VMenu-Dr7W90Y8.js";import{V as rl}from"./VDivider-BOPuQHw-.js";import{V as sl}from"./VAvatar-CsOZoIOv.js";import{V as dl}from"./VSpacer-DSkmVMFK.js";import"./loader-_1sodkhb.js";import"./elevation-C2i0gTrO.js";import"./index-D7kFa585.js";import"./VSlideGroup-BFt0nLex.js";/* empty css              */const cl=t({...c(),...d({variant:"text"})},"VToolbarItems"),vl=a()({name:"VToolbarItems",props:cl(),setup(e,l){let{slots:a}=l;return o({VBtn:{color:n(()=>e.color),height:"inherit",variant:n(()=>e.variant)}}),i(()=>{var l;return u("div",{class:s(["v-toolbar-items",e.class]),style:r(e.style)},[null==(l=a.default)?void 0:l.call(a)])}),{}}}),pl=t({...f(Be(),["hideDefaultFooter"]),...Pe(),...Ce(),...Ie()},"VDataTableVirtual"),ml=a()({name:"VDataTableVirtual",props:pl(),emits:{"update:modelValue":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0},setup(e,l){let{attrs:a,slots:t}=l;const{groupBy:r}=re(e),{initialSortOrder:s,sortBy:d,multiSort:c,mustSort:b}=se(e),{disableSort:x}=v(e),{columns:k,headers:w,filterFunctions:V,sortFunctions:S,sortRawFunctions:D}=de(e,{groupBy:r,showSelect:n(()=>e.showSelect),showExpand:n(()=>e.showExpand)}),{items:I}=ce(e,k),C=n(()=>e.search),{filteredItems:P}=ve(e,I,C,{transform:e=>e.columns,customKeyFilter:V}),{toggleSort:B}=pe({initialSortOrder:s,sortBy:d,multiSort:c,mustSort:b}),{sortByWithGroups:_,opened:T,extractRows:A,isGroupOpen:E,toggleGroup:j}=me({groupBy:r,sortBy:d,disableSort:x}),{sortedItems:F}=fe(e,P,_,{transform:e=>({...e.raw,...e.columns}),sortFunctions:S,sortRawFunctions:D}),{flatItems:R}=ge(F,r,T,()=>!!t["group-summary"]),z=p(()=>A(R.value)),{isSelected:O,select:U,selectAll:G,toggleSelect:H,someSelected:L,allSelected:$}=ye(e,{allItems:z,currentPage:z}),{isExpanded:M,toggleExpand:N}=he(e),{containerRef:q,markerRef:K,paddingTop:Y,paddingBottom:W,computedItems:Q,handleItemResize:X,handleScroll:Z,handleScrollend:J,calculateVisibleItems:ee,scrollToIndex:le}=be(e,R),ae=p(()=>Q.value.map(e=>({...e.raw,virtualIndex:e.index})));xe({sortBy:d,page:m(1),itemsPerPage:m(-1),groupBy:r,search:C}),o({VDataTableRows:{hideNoData:n(()=>e.hideNoData),noDataText:n(()=>e.noDataText),loading:n(()=>e.loading),loadingText:n(()=>e.loadingText)}});const te=p(()=>({sortBy:d.value,toggleSort:B,someSelected:L.value,allSelected:$.value,isSelected:O,select:U,selectAll:G,toggleSelect:H,isExpanded:M,toggleExpand:N,isGroupOpen:E,toggleGroup:j,items:z.value.map(e=>e.raw),internalItems:z.value,groupedItems:R.value,columns:k.value,headers:w.value}));return i(()=>{const l=ke.filterProps(f(e,["multiSort"])),o=we.filterProps(e),n=Ve.filterProps(e);return g(Ve,y({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},n,{fixedHeader:e.fixedHeader||e.sticky}),{top:()=>{var e;return null==(e=t.top)?void 0:e.call(t,te.value)},wrapper:()=>{var n,i,r,s,d,c;return u("div",{ref:q,onScrollPassive:Z,onScrollend:J,class:"v-table__wrapper",style:{height:h(e.height)}},[u("table",null,[null==(n=t.colgroup)?void 0:n.call(t,te.value),!e.hideDefaultHeader&&u("thead",{key:"thead"},[g(ke,y(l,{multiSort:!!e.multiSort}),t)]),null==(i=t.thead)?void 0:i.call(t,te.value),!e.hideDefaultBody&&u("tbody",{key:"tbody"},[u("tr",{ref:K,style:{height:h(Y.value),border:0}},[u("td",{colspan:k.value.length,style:{height:0,border:0}},null)]),null==(r=t["body.prepend"])?void 0:r.call(t,te.value),g(we,y(a,o,{items:ae.value}),{...t,item:e=>g(Se,{key:e.internalItem.index,renderless:!0,"onUpdate:height":l=>X(e.internalItem.index,l)},{default:l=>{var a;let{itemRef:o}=l;return(null==(a=t.item)?void 0:a.call(t,{...e,itemRef:o}))??g(De,y(e.props,{ref:o,key:e.internalItem.index,index:e.index}),t)}})}),null==(s=t["body.append"])?void 0:s.call(t,te.value),u("tr",{style:{height:h(W.value),border:0}},[u("td",{colspan:k.value.length,style:{height:0,border:0}},null)])]),null==(d=t.tbody)?void 0:d.call(t,te.value),null==(c=t.tfoot)?void 0:c.call(t,te.value)])])},bottom:()=>{var e;return null==(e=t.bottom)?void 0:e.call(t,te.value)}})}),{calculateVisibleItems:ee,scrollToIndex:le}}}),fl=t({itemsLength:{type:[Number,String],required:!0},...je(),...Be(),...Ee()},"VDataTableServer"),gl=a()({name:"VDataTableServer",props:fl(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,l){let{attrs:a,slots:t}=l;const{groupBy:r}=re(e),{initialSortOrder:s,sortBy:d,multiSort:c,mustSort:m}=se(e),{page:h,itemsPerPage:k}=_e(e),{disableSort:w}=v(e),V=p(()=>parseInt(e.itemsLength,10)),{columns:S,headers:D}=de(e,{groupBy:r,showSelect:n(()=>e.showSelect),showExpand:n(()=>e.showExpand)}),{items:I}=ce(e,S),{toggleSort:C}=pe({initialSortOrder:s,sortBy:d,multiSort:c,mustSort:m,page:h}),{opened:P,isGroupOpen:B,toggleGroup:_,extractRows:T}=me({groupBy:r,sortBy:d,disableSort:w}),{pageCount:A,setItemsPerPage:E}=Te({page:h,itemsPerPage:k,itemsLength:V}),{flatItems:j}=ge(I,r,P,()=>!!t["group-summary"]),{isSelected:F,select:R,selectAll:z,toggleSelect:O,someSelected:U,allSelected:G}=ye(e,{allItems:I,currentPage:I}),{isExpanded:H,toggleExpand:L}=he(e),$=p(()=>T(I.value));xe({page:h,itemsPerPage:k,sortBy:d,groupBy:r,search:n(()=>e.search)}),x("v-data-table",{toggleSort:C,sortBy:d}),o({VDataTableRows:{hideNoData:n(()=>e.hideNoData),noDataText:n(()=>e.noDataText),loading:n(()=>e.loading),loadingText:n(()=>e.loadingText)}});const M=p(()=>({page:h.value,itemsPerPage:k.value,sortBy:d.value,pageCount:A.value,toggleSort:C,setItemsPerPage:E,someSelected:U.value,allSelected:G.value,isSelected:F,select:R,selectAll:z,toggleSelect:O,isExpanded:H,toggleExpand:L,isGroupOpen:B,toggleGroup:_,items:$.value.map(e=>e.raw),internalItems:$.value,groupedItems:j.value,columns:S.value,headers:D.value}));i(()=>{const l=Ae.filterProps(e),o=ke.filterProps(f(e,["multiSort"])),n=we.filterProps(e),i=Ve.filterProps(e);return g(Ve,y({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},i,{fixedHeader:e.fixedHeader||e.sticky}),{top:()=>{var e;return null==(e=t.top)?void 0:e.call(t,M.value)},default:()=>{var l,i,r,s,d,c;return t.default?t.default(M.value):u(b,null,[null==(l=t.colgroup)?void 0:l.call(t,M.value),!e.hideDefaultHeader&&u("thead",{key:"thead",class:"v-data-table__thead",role:"rowgroup"},[g(ke,y(o,{multiSort:!!e.multiSort}),t)]),null==(i=t.thead)?void 0:i.call(t,M.value),!e.hideDefaultBody&&u("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[null==(r=t["body.prepend"])?void 0:r.call(t,M.value),t.body?t.body(M.value):g(we,y(a,n,{items:j.value}),t),null==(s=t["body.append"])?void 0:s.call(t,M.value)]),null==(d=t.tbody)?void 0:d.call(t,M.value),null==(c=t.tfoot)?void 0:c.call(t,M.value)])},bottom:()=>t.bottom?t.bottom(M.value):!e.hideDefaultFooter&&u(b,null,[g(rl,null,null),g(Ae,l,{prepend:t["footer.prepend"]})])})})}}),yl={__name:"Confirm",props:{modelValue:{type:Boolean,required:!1},title:{type:String,required:!0,default:"提示"},text:{type:String,required:!0},confirm:{type:Function}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,t=k(!1),o=e=>{e.value=!1,n("update:modelValue",!1)},n=l;return(l,n)=>(V(),w(ue,{"model-value":e.modelValue,"max-width":"400",persistent:""},{activator:S(({props:e})=>[P(l.$slots,"btn",{dialog:e})]),default:S(({isActive:l})=>[g(ae,{title:e.title,text:e.text},{default:S(()=>[g(te,null,{default:S(()=>[g(ne,{color:"grey",onClick:D(e=>o(l),["stop"])},{default:S(()=>[...n[0]||(n[0]=[I("取消",-1)])]),_:1},8,["onClick"]),g(ne,{color:"primary",loading:C(t),disabled:C(t),onClick:D(e=>(async e=>{if(!a.confirm)return o(e);const l="AsyncFunction"===a.confirm.constructor.name;try{t.value=!0,l?await a.confirm():a.confirm(),o(e)}finally{t.value=!1}})(l),["stop"])},{default:S(()=>[...n[1]||(n[1]=[I(" 确认 ",-1)])]),_:1},8,["loading","disabled","onClick"])]),_:2},1024)]),_:2},1032,["title","text"])]),_:3},8,["model-value"]))}},hl=t({filterByType:String},"file-accept"),bl=t({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>"boolean"==typeof e||[1e3,1024].includes(+e)},truncateLength:{type:[Number,String],default:22},...Qe({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>T(e).every(e=>null!=e&&"object"==typeof e)},...hl(),...We({clearable:!0})},"VFileInput"),xl=a()({name:"VFileInput",inheritAttrs:!1,props:bl(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,rejected:e=>!0},setup(a,t){function o(){var e;W.value!==document.activeElement&&(null==(e=W.value)||e.focus()),U.value||G()}function r(e){var l;null==(l=W.value)||l.click()}function d(e){D("mousedown:control",e)}function c(e){var l;null==(l=W.value)||l.click(),D("click:control",e)}function v(e){e.stopPropagation(),o(),R(()=>{O.value=[],z(a["onClick:clear"],e)})}function f(e){e.preventDefault(),e.stopImmediatePropagation(),Z.value=!0}function h(e){e.preventDefault(),Z.value=!1}async function x(e){e.preventDefault(),e.stopImmediatePropagation(),Z.value=!1,W.value&&ee(e)&&V(await J(e))}function w(e){e.target&&!e.repack&&(a.filterByType?V([...e.target.files]):O.value=[...e.target.files??[]])}function V(e){const l=new DataTransfer,{accepted:a,rejected:t}=P(e);t.length&&D("rejected",t);for(const n of a)l.items.add(n);W.value.files=l.files,O.value=[...l.files];const o=new Event("change",{bubbles:!0});o.repack=!0,W.value.dispatchEvent(o)}let{attrs:S,emit:D,slots:I}=t;const{t:C}=B(),{filterAccepted:P}=function(e){const l=p(()=>e.filterByType?function(e){const l=e.split(",").map(e=>e.trim().toLowerCase()),a=l.filter(e=>e.startsWith(".")),t=l.filter(e=>e.endsWith("/*")),o=l.filter(e=>!a.includes(e)&&!t.includes(e));return e=>{var l,n;const i=(null==(l=e.name.split(".").at(-1))?void 0:l.toLowerCase())??"",u=(null==(n=e.type.split("/").at(0))?void 0:n.toLowerCase())??"";return o.includes(e.type)||a.includes("."+i)||t.includes(u+"/*")}}(e.filterByType):null);return{filterAccepted:function(e){if(l.value){const a=e.filter(l.value);return{accepted:a,rejected:e.filter(e=>!a.includes(e))}}return{accepted:e,rejected:[]}}}}(a),O=_(a,"modelValue",a.modelValue,e=>T(e),e=>!a.multiple&&Array.isArray(e)?e[0]:e),{isFocused:U,focus:G,blur:H}=Ne(a),L=p(()=>"boolean"!=typeof a.showSize?a.showSize:void 0),$=p(()=>(O.value??[]).reduce((e,l)=>{let{size:a=0}=l;return e+a},0)),M=p(()=>A($.value,L.value)),N=p(()=>(O.value??[]).map(e=>{const{name:l="",size:t=0}=e,o=function(e){if(+a.truncateLength>e.length)return e;const l=Math.floor((+a.truncateLength-1)/2);return`${e.slice(0,l)}…${e.slice(e.length-l)}`}(l);return a.showSize?`${o} (${A(t,L.value)})`:o})),q=p(()=>{var e;const l=(null==(e=O.value)?void 0:e.length)??0;return a.showSize?C(a.counterSizeString,l,M.value):C(a.counterString,l)}),K=k(),Y=k(),W=k(),Q=n(()=>U.value||a.active),X=p(()=>["plain","underlined"].includes(a.variant)),Z=m(!1),{handleDrop:J,hasFilesOrFolders:ee}={handleDrop:async function(a){var t,o;const n=[],i=[...(null==(t=a.dataTransfer)?void 0:t.items)??[]].filter(e=>"file"===e.kind).map(e=>e.webkitGetAsEntry()).filter(Boolean);if(i.length)for(const u of i){const a=await e(u,l(".",u));n.push(...a.map(e=>e.file))}else n.push(...(null==(o=a.dataTransfer)?void 0:o.files)??[]);return n},hasFilesOrFolders:function(e){var l,a;return[...(null==(l=e.dataTransfer)?void 0:l.items)??[]].filter(e=>"file"===e.kind).map(e=>e.webkitGetAsEntry()).filter(Boolean).length>0||[...(null==(a=e.dataTransfer)?void 0:a.files)??[]].length>0}};return E(O,e=>{(!Array.isArray(e)||!e.length)&&W.value&&(W.value.value="")}),i(()=>{const e=!(!I.counter&&!a.counter),l=!(!e&&!I.details),[t,n]=j(S),{modelValue:i,...p}=qe.filterProps(a),m={...Ke.filterProps(a),"onClick:clear":v},k=void 0!==S.webkitdirectory&&!1!==S.webkitdirectory?void 0:a.filterByType??(S.accept?S.accept+"":void 0);return g(qe,y({ref:K,modelValue:a.multiple?O.value:O.value[0],class:["v-file-input",{"v-file-input--chips":!!a.chips,"v-file-input--dragging":Z.value,"v-file-input--hide":a.hideInput,"v-input--plain-underlined":X.value},a.class],style:a.style,"onClick:prepend":r},t,p,{centerAffix:!X.value,focused:U.value}),{...I,default:e=>{let{id:l,isDisabled:t,isDirty:i,isReadonly:r,isValid:v,hasDetails:p}=e;return g(Ke,y({ref:Y,prependIcon:a.prependIcon,onMousedown:d,onClick:c,"onClick:prependInner":a["onClick:prependInner"],"onClick:appendInner":a["onClick:appendInner"]},m,{id:l.value,active:Q.value||i.value,dirty:i.value||a.dirty,disabled:t.value,focused:U.value,details:p.value,error:!1===v.value,onDragover:f,onDrop:x}),{...I,default:e=>{var l;let{props:{class:i,...d},controlRef:c}=e;return u(b,null,[u("input",y({ref:e=>W.value=c.value=e,type:"file",accept:k,readonly:r.value,disabled:t.value,multiple:a.multiple,name:a.name,onClick:e=>{e.stopPropagation(),r.value&&e.preventDefault(),o()},onChange:w,onDragleave:h,onFocus:o,onBlur:H},d,n),null),u("div",{class:s(i)},[!!(null==(l=O.value)?void 0:l.length)&&!a.hideInput&&(I.selection?I.selection({fileNames:N.value,totalBytes:$.value,totalBytesReadable:M.value}):a.chips?N.value.map(e=>g(Fe,{key:e,size:"small",text:e},null)):N.value.join(", "))])])}})},details:l?l=>{var t,o;return u(b,null,[null==(t=I.details)?void 0:t.call(I,l),e&&u(b,null,[u("span",null,null),g(Ye,{active:!!(null==(o=O.value)?void 0:o.length),value:q.value,disabled:a.disabled},I.counter)])])}:void 0})}),F({},K,Y,W)}}),kl={class:"text-center pa-4"},wl={__name:"ImportLines",setup(e){const l=O("axios"),a=m(!1);E(a,e=>{e||(i.value=[],t.value=null)});const t=k(null),o=[{title:"序号",key:"id",width:100},{title:"链接",key:"link",width:280},{title:"名称",key:"name",width:260},{title:"状态",key:"status",width:100},{title:"错误",key:"error"}],n=k(!1),i=k([]),u=async e=>{try{(await l.post("/webdav/manage/list",e.map(e=>(e.loading=!0,e.link)))).forEach((l,a)=>Object.assign(e[a],l))}catch(a){e.forEach(e=>{e.success=!1,e.error=a.message||"导入失败"})}finally{e.forEach(e=>e.loading=!1)}},r=async()=>{if(0===i.value.length)return;n.value=!0;const e=new Set;for(let l=0;i.value.length>l;l+=5){const a=i.value.slice(l,l+5),t=u(a);e.add(t),t.finally(()=>e.delete(t)),2>e.size||await Promise.race(e)}await Promise.all(e),n.value=!1},s=async e=>{const l=e.target.files[0];if(!l)return;const a=new TextDecoder("utf-8"),t=l.stream().getReader();let{value:o,done:n}=await t.read(),u="",r=0;for(;!n;){u+=a.decode(o,{stream:!0});let e=u.split(/\r?\n/);u=e.pop();for(let l of e)l=l.trim(),l&&i.value.push({id:++r,link:l});({value:o,done:n}=await t.read())}u&&(u=u.trim(),u&&i.value.push({id:++r,link:u}))};return(e,l)=>(V(),U("div",kl,[g(ue,{modelValue:C(a),"onUpdate:modelValue":l[2]||(l[2]=e=>G(a)?a.value=e:null),transition:"dialog-bottom-transition",fullscreen:""},{activator:S(({props:e})=>[g(ne,y({class:"mr-2",icon:"mdi-import",density:"comfortable",variant:"text"},e),null,16)]),default:S(()=>[g(ml,{class:"h-100",headers:o,items:C(i),hover:"",fixedHeader:""},{top:S(()=>[g($e,{flat:"",density:"compact"},{default:S(()=>[g(Me,null,{default:S(()=>[...l[3]||(l[3]=[I("导入分享数据",-1)])]),_:1}),g(vl,null,{default:S(()=>[g(xl,{ref_key:"inputFile",ref:t,accept:".txt",class:"d-none",onChange:s},null,512),g(ne,{text:"加载文件",variant:"text",onClick:l[0]||(l[0]=e=>C(t).click()),disabled:C(n)},null,8,["disabled"]),g(ne,{text:"开始任务",variant:"text",onClick:r,loading:C(n)},null,8,["loading"])]),_:1}),g(ne,{icon:"mdi-close",onClick:l[1]||(l[1]=e=>a.value=!1),disabled:C(n)},null,8,["disabled"])]),_:1})]),"item.status":S(({item:e})=>[e.loading?(V(),w(ie,{key:0,size:18,width:2,color:"green",indeterminate:""})):e.success?(V(),w(Le,{key:1,icon:"mdi-check",color:"green"})):!1===e.success?(V(),w(Le,{key:2,icon:"mdi-close",color:"red"})):(V(),w(Le,{key:3,icon:"mdi-help",color:"grey"}))]),_:1},8,["items"])]),_:1},8,["modelValue"])]))}},Vl=t({alwaysFilter:Boolean,autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Ie({filterKeys:["title"]}),...He({hideNoData:!0,returnObject:!0}),...f(ll({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VCombobox"),Sl=a()({name:"VCombobox",props:Vl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,l){function a(l){J=!0,R(()=>J=!1),e.openOnClear&&(ke.value=!0)}function t(){be.value||(ke.value=!0)}function o(e){be.value||(O.value&&(e.preventDefault(),e.stopPropagation()),ke.value=!ke.value)}function d(e){var l;(Y(e)||"Backspace"===e.key)&&(null==(l=z.value)||l.focus())}function c(l){var a,t,o,n;if(W(l)||ue.isReadonly.value)return;const i=null==(a=z.value)?void 0:a.selectionStart,u=ie.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(l.key)&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(ke.value=!0),["Escape"].includes(l.key)&&(ke.value=!1),Ce.value&&["Enter","Tab"].includes(l.key)&&Ie.value&&!ie.value.some(e=>{let{value:l}=e;return l===Ie.value.value})&&x(Ie.value),"ArrowDown"===l.key&&Ce.value&&(null==(t=Pe.value)||t.focus("next")),"Enter"===l.key&&me.value&&(x(tl(e,me.value),!0,!0),de.value&&(ce.value="")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&de.value&&ie.value.length>0&&!me.value)return x(ie.value[0],!1);if(~Z.value){l.preventDefault();const e=Z.value;x(ie.value[Z.value],!1),Z.value=u-1>e?e:u-2}else"Backspace"!==l.key||me.value||(Z.value=u-1)}else if(e.multiple)if("ArrowLeft"===l.key){if(0>Z.value&&i&&i>0)return;const e=Z.value>-1?Z.value-1:u-1;ie.value[e]?Z.value=e:(Z.value=-1,null==(o=z.value)||o.setSelectionRange(me.value.length,me.value.length))}else if("ArrowRight"===l.key){if(0>Z.value)return;const e=Z.value+1;ie.value[e]?Z.value=e:(Z.value=-1,null==(n=z.value)||n.setSelectionRange(0,0))}else~Z.value&&Y(l)&&(Z.value=-1)}function v(l){var a;const t=w((null==(a=null==l?void 0:l.clipboardData)?void 0:a.getData("Text"))??"");t.length>1&&e.multiple&&(l.preventDefault(),V(t))}function f(){var l;e.eager&&(null==(l=X.value)||l.calculateVisibleItems())}function h(){var e;O.value&&(null==(e=z.value)||e.focus()),U.value=!0,pe.value=null}function x(l){let a=1>=arguments.length||void 0===arguments[1]||arguments[1],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(l&&!l.props.disabled)if(e.multiple){const t=ie.value.findIndex(a=>(e.valueComparator||L)(a.value,l.value)),o=null==a?!~t:a;if(~t){const e=o?[...ie.value,l]:[...ie.value];e.splice(t,1),ie.value=e}else o&&(ie.value=[...ie.value,l]);e.clearOnSelect&&(me.value="")}else{const o=!1!==a;ie.value=o?[l]:[],U.value&&!e.alwaysFilter||!ce.value||(pe.value=ce.value),ce.value=o&&!de.value?l.title:"",R(()=>{ke.value=t,U.value=!0})}}function w(l){const a=["\n",...e.delimiters??[]].map(K).join("|");return l.split(RegExp(`(?:${a})+`))}async function V(l){for(let a of l)a=a.trim(),a&&(x(tl(e,a)),await R())}function S(e){O.value=!0,setTimeout(()=>{G.value=!0})}function D(e){G.value=!1}var C;let{emit:P,slots:A}=l;const{t:j}=B(),z=k(),O=m(!1),U=m(!0),G=m(!1),Q=k(),X=k(),Z=m(-1);let J=!1;const{items:ee,transformIn:le,transformOut:ae}=al(e),{textColorClasses:te,textColorStyles:oe}=H(()=>{var e;return null==(e=z.value)?void 0:e.color}),{InputIcon:ne}=Xe(e),ie=_(e,"modelValue",[],e=>le(T(e)),l=>{const a=ae(l);return e.multiple?a:a[0]??null}),ue=Ze(e),re=n(()=>e.closableChips&&!ue.isReadonly.value&&!ue.isDisabled.value),se=p(()=>!(!e.chips&&!A.chip)),de=p(()=>se.value||!!A.selection),ce=m(e.multiple||de.value?"":(null==(C=ie.value[0])?void 0:C.title)??""),pe=m(null),me=p({get:()=>ce.value,set:async l=>{var a;if(ce.value=l??"",null===l||""===l&&!e.multiple&&!de.value?ie.value=[]:e.multiple||de.value||(ie.value=[tl(e,l)],R(()=>{var e;return null==(e=X.value)?void 0:e.scrollToIndex(0)})),l&&e.multiple&&(null==(a=e.delimiters)?void 0:a.length)){const e=w(l);e.length>1&&(V(e),ce.value="")}l||(Z.value=-1),U.value=!l}}),fe=p(()=>"function"==typeof e.counterValue?e.counterValue(ie.value):"number"==typeof e.counterValue?e.counterValue:e.multiple?ie.value.length:me.value.length),{filteredItems:ge,getMatches:ye}=ve(e,ee,()=>pe.value??(e.alwaysFilter||!U.value?me.value:"")),he=p(()=>e.hideSelected&&null===pe.value?ge.value.filter(e=>!ie.value.some(l=>l.value===e.value)):ge.value),be=p(()=>e.hideNoData&&!he.value.length||ue.isReadonly.value||ue.isDisabled.value),xe=_(e,"menu"),ke=p({get:()=>xe.value,set:e=>{var l;xe.value&&!e&&(null==(l=Q.value)?void 0:l.ΨopenChildren.size)||e&&be.value||(xe.value=e)}}),{menuId:we,ariaExpanded:Ve,ariaControls:Se}=Re(e,ke);E(ce,e=>{J?R(()=>J=!1):O.value&&!ke.value&&(ke.value=!0),P("update:search",e)}),E(ie,l=>{var a;e.multiple||de.value||(ce.value=(null==(a=l[0])?void 0:a.title)??"")});const De=p(()=>ie.value.map(e=>e.value)),Ie=p(()=>he.value.find(e=>"item"===e.type&&!e.props.disabled)),Ce=p(()=>{var l;return(!0===e.autoSelectFirst||"exact"===e.autoSelectFirst&&me.value===(null==(l=Ie.value)?void 0:l.title))&&he.value.length>0&&!U.value&&!G.value}),Pe=k(),Be=ze(Pe,z);return E(O,(l,a)=>{if(!l&&l!==a&&(Z.value=-1,ke.value=!1,me.value)){if(e.multiple)return void x(tl(e,me.value));if(!de.value)return;ie.value.some(e=>{let{title:l}=e;return l===me.value})?ce.value="":x(tl(e,me.value))}}),E(ke,l=>{if(!e.hideSelected&&l&&ie.value.length&&U.value){const l=he.value.findIndex(l=>ie.value.some(a=>(e.valueComparator||L)(a.value,l.value)));$&&window.requestAnimationFrame(()=>{var e;l>=0&&(null==(e=X.value)||e.scrollToIndex(l))})}l&&(pe.value=null)}),E(ee,(e,l)=>{ke.value||O.value&&!l.length&&e.length&&(ke.value=!0)}),i(()=>{const l=!!(!e.hideNoData||he.value.length||A["prepend-item"]||A["append-item"]||A["no-data"]),n=ie.value.length>0,i=el.filterProps(e);return g(el,y({ref:z},i,{modelValue:me.value,"onUpdate:modelValue":e=>me.value=e,focused:O.value,"onUpdate:focused":e=>O.value=e,validationValue:ie.externalValue,counterValue:fe.value,dirty:n,class:["v-combobox",{"v-combobox--active-menu":ke.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!de.value,"v-combobox--selecting-index":Z.value>-1,["v-combobox--"+(e.multiple?"multiple":"single")]:!0},e.class],style:e.style,readonly:ue.isReadonly.value,placeholder:n?void 0:e.placeholder,"onClick:clear":a,"onMousedown:control":t,onKeydown:c,onPaste:v,"aria-expanded":Ve.value,"aria-controls":Se.value}),{...A,default:a=>{let{id:t}=a;return u(b,null,[g(ol,y({id:we.value,ref:Q,modelValue:ke.value,"onUpdate:modelValue":e=>ke.value=e,activator:"parent",contentClass:"v-combobox__content",disabled:be.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:f,onAfterLeave:h},e.menuProps),{default:()=>[l&&g(nl,y({ref:Pe,filterable:!0,selected:De.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),selectable:!0,onKeydown:d,onFocusin:S,onFocusout:D,tabindex:"-1","aria-live":"polite","aria-labelledby":t.value+"-label","aria-multiselectable":e.multiple,color:e.itemColor??e.color},Be,e.listProps),{default:()=>{var l,a,t;return[null==(l=A["prepend-item"])?void 0:l.call(A),!he.value.length&&!e.hideNoData&&((null==(a=A["no-data"])?void 0:a.call(A))??g(il,{key:"no-data",title:j(e.noDataText)},null)),g(Oe,{ref:X,renderless:!0,items:he.value,itemKey:"value"},{default:l=>{var a,t,o;let{item:n,index:i,itemRef:r}=l;const s=y(n.props,{ref:r,key:n.value,active:!(!Ce.value||n!==Ie.value)||void 0,onClick:()=>x(n,null),"aria-posinset":i+1,"aria-setsize":he.value.length});return"divider"===n.type?(null==(a=A.divider)?void 0:a.call(A,{props:n.raw,index:i}))??g(rl,y(n.props,{key:"divider-"+i}),null):"subheader"===n.type?(null==(t=A.subheader)?void 0:t.call(A,{props:n.raw,index:i}))??g(ul,y(n.props,{key:"subheader-"+i}),null):(null==(o=A.item)?void 0:o.call(A,{item:n,index:i,props:s}))??g(il,y(s,{role:"option"}),{prepend:l=>{let{isSelected:a}=l;return u(b,null,[e.multiple&&!e.hideSelected?g(Ge,{key:n.value,modelValue:a,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:e=>e.preventDefault()},null):void 0,n.props.prependAvatar&&g(sl,{image:n.props.prependAvatar},null),n.props.prependIcon&&g(Le,{icon:n.props.prependIcon},null)])},title:()=>{var e;return U.value?n.title:Ue("v-combobox",n.title,null==(e=ye(n))?void 0:e.title)}})}}),null==(t=A["append-item"])?void 0:t.call(A)]}})]}),ie.value.map((l,a)=>{function t(e){e.stopPropagation(),e.preventDefault(),x(l,!1)}const o=y(Fe.filterProps(l.props),{"onClick:close":t,onKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),t(e))},onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),n=se.value?!!A.chip:!!A.selection,i=n?N(se.value?A.chip({item:l,index:a,props:o}):A.selection({item:l,index:a})):void 0;if(!n||i)return u("div",{key:l.value,class:s(["v-combobox__selection",a===Z.value&&["v-combobox__selection--selected",te.value]]),style:r(a===Z.value?oe.value:{})},[se.value?A.chip?g(q,{key:"chip-defaults",defaults:{VChip:{closable:re.value,size:"small",text:l.title}}},{default:()=>[i]}):g(Fe,y({key:"chip",closable:re.value,size:"small",text:l.title,disabled:l.props.disabled},o),null):i??u("span",{class:"v-combobox__selection-text"},[l.title,e.multiple&&ie.value.length-1>a&&u("span",{class:"v-combobox__selection-comma"},[I(",")])])])})])},"append-inner":function(){for(var l,a,t=arguments.length,n=Array(t),i=0;t>i;i++)n[i]=arguments[i];return u(b,null,[null==(l=A["append-inner"])?void 0:l.call(A,...n),e.hideNoData&&!e.items.length||!e.menuIcon?void 0:g(Le,{class:"v-combobox__menu-icon",color:null==(a=z.value)?void 0:a.fieldIconColor,icon:e.menuIcon,onMousedown:o,onClick:M,"aria-hidden":!0,tabindex:"-1"},null),e.appendInnerIcon&&g(ne,{key:"append-icon",name:"appendInner",color:n[0].iconColor.value},null)])}})}),F({isFocused:O,isPristine:U,menu:ke,search:me,selectionIndex:Z,filteredItems:ge,select:x},z)}}),Dl=t({modelValue:null,color:String,cancelText:{type:String,default:"$vuetify.confirmEdit.cancel"},okText:{type:String,default:"$vuetify.confirmEdit.ok"},disabled:{type:[Boolean,Array],default:void 0},hideActions:Boolean},"VConfirmEdit"),Il=a()({name:"VConfirmEdit",props:Dl(),emits:{cancel:()=>!0,save:e=>!0,"update:modelValue":e=>!0},setup(e,l){function a(l){return"boolean"==typeof e.disabled?e.disabled:Array.isArray(e.disabled)?e.disabled.includes(l):m.value}function t(){d.value=c.value,r("save",c.value)}function o(){c.value=structuredClone(X(d.value)),r("cancel")}function n(l){return u(b,null,[g(ne,y({disabled:h.value,variant:"text",color:e.color,onClick:o,text:v(e.cancelText)},l),null),g(ne,y({disabled:f.value,variant:"text",color:e.color,onClick:t,text:v(e.okText)},l),null)])}let{emit:r,slots:s}=l;const d=_(e,"modelValue"),c=k();Q(()=>{c.value=structuredClone(X(d.value))});const{t:v}=B(),m=p(()=>L(d.value,c.value)),f=p(()=>a("save")),h=p(()=>a("cancel"));let x=!1;return i(()=>{var l;return u(b,null,[null==(l=s.default)?void 0:l.call(s,{model:c,save:t,cancel:o,isPristine:m.value,get actions(){return x=!0,n}}),!e.hideActions&&!x&&n()])}),{save:t,cancel:o,isPristine:m}}}),Cl={class:"container"},Pl={class:"d-sm-flex"},Bl="/webdav/manage/list",_l=Je({__name:"webdav",setup(e){const l=O("axios"),a=k({page:1,itemsPerPage:25,type:"",kw:""}),t=[{title:"名称",key:"name",sortable:!1},{title:"网盘类型",key:"type",width:100,sortable:!1},{title:"更新时间",key:"updatedAt",width:180,align:"center",sortable:!1},{title:"操作",key:"actions",align:"end",sortable:!1,width:"80px"}],o=k([]),n=k({items:[],total:0}),i=k(!1),r=async e=>{i.value=!0;try{n.value=await l.get(Bl,{params:Object.assign({},e,a.value)})}catch{}finally{i.value=!1}},s=async()=>{i.value=!0;try{await l.delete(Bl,{data:{ids:o.value}}),o.value=[],await r(a.value)}catch{}finally{i.value=!1}},d=async()=>{i.value=!0;try{await l.put(Bl,p.value),await r(a.value),c.value=!1}catch(e){edit.msg=e.message||"修改失败，请稍后再试"}finally{i.value=!1}},c=k(!1),v=k(null),p=k({}),m=k(null);return(e,l)=>{const f=wl,h=yl;return V(),U("div",Cl,[g(gl,{class:"h-100",page:C(a).page,"onUpdate:page":l[6]||(l[6]=e=>C(a).page=e),"items-per-page":C(a).itemsPerPage,"onUpdate:itemsPerPage":l[7]||(l[7]=e=>C(a).itemsPerPage=e),headers:t,items:C(n).items,"items-length":C(n).total,loading:C(i),"onUpdate:options":r,hover:"",fixedHeader:"",fixedFooter:"",hideDefaultHeader:!1,"show-select":"",modelValue:C(o),"onUpdate:modelValue":l[8]||(l[8]=e=>G(o)?o.value=e:null)},{top:S(()=>[g($e,{class:"pl-4 pr-4",flat:"",density:"compact"},{default:S(()=>[g(Le,{icon:"mdi-list-box"}),u("div",Pl,[g(el,{width:"200",class:"ml-2",modelValue:C(a).kw,"onUpdate:modelValue":l[0]||(l[0]=e=>C(a).kw=e),modelModifiers:{lazy:!0},density:"compact",label:"关键词","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":"","onClick:prependInner":l[1]||(l[1]=e=>r(C(a))),onKeydown:l[2]||(l[2]=ee(e=>r(C(a)),["enter"]))},null,8,["modelValue"]),g(Sl,{width:"110",class:"ml-2",modelValue:C(a).type,"onUpdate:modelValue":l[3]||(l[3]=e=>C(a).type=e),density:"compact",label:"类型",items:["baidu","a189","a115","uc","quark","a123"],variant:"solo-filled",flat:"","hide-details":"","single-line":""},null,8,["modelValue"])]),g(ne,{class:"ml-2",icon:"mdi-magnify",density:"comfortable",variant:"text",onClick:l[4]||(l[4]=D(e=>r(C(a)),["stop"]))}),g(dl),g(f),g(h,{title:"警告",text:"此操作不可逆！",confirm:s},{btn:S(({dialog:e})=>[g(ne,y({class:"mr-2",icon:"mdi-delete",density:"comfortable",variant:"text",disabled:!C(o).length||C(i)},e),null,16,["disabled"])]),_:1})]),_:1})]),"item.updatedAt":S(({item:e})=>[I(Z(e.updatedAt?C(J)(e.updatedAt).format("YYYY-MM-DD HH:mm:ss"):""),1)]),"item.actions":S(({item:e})=>[g(ne,{icon:"mdi-pencil",density:"comfortable",size:"small",variant:"text",onClick:l=>p.value=e,onMouseenter:l[5]||(l[5]=e=>v.value=e.currentTarget)},null,8,["onClick"])]),_:1},8,["page","items-per-page","items","items-length","loading","modelValue"]),g(ue,{modelValue:C(c),"onUpdate:modelValue":l[11]||(l[11]=e=>G(c)?c.value=e:null),activator:C(v),"max-width":"500"},{default:S(()=>[g(Il,{modelValue:C(p),"onUpdate:modelValue":l[9]||(l[9]=e=>G(p)?p.value=e:null),"cancel-text":"取消","ok-text":"更新",onCancel:l[10]||(l[10]=e=>c.value=!1),onSave:d},{default:S(({model:e,actions:l})=>[g(ae,{title:"修改目录名称"},{actions:S(()=>[g(dl),(V(),w(le(l)))]),default:S(()=>[g(oe,null,{default:S(()=>[g(el,{modelValue:e.value.name,"onUpdate:modelValue":l=>e.value.name=l,variant:"underlined",rules:[e=>!!e||"名称不能为空"],"error-messages":C(m),error:!!C(m)},null,8,["modelValue","onUpdate:modelValue","rules","error-messages","error"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"])]),_:1},8,["modelValue","activator"])])}}},[["__scopeId","data-v-cc855ae0"]]);export{_l as default};
