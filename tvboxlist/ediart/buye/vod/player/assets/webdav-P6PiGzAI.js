import{p as e,j as l,aE as a,s as t,at as o,y as n,H as u,d as i,aK as s,C as r,A as d,I as c,m as v,an as p,F as m,t as f,b as g,c as y,w as h,aL as b,P as x,e as V,f as k,aM as w,a5 as S,af as C,aN as I,W as _,aC as P,ai as D,ar as B,aJ as A,Z as E,g as T,ad as j,ah as F,a4 as R,a6 as z,aO as U,aP as O,a2 as M,aQ as G,aR as N,aS as H,G as $,aT as q,aU as L,L as K,aV as Y,M as W,aW as J,i as Q}from"./index-CAPtrJAk.js";import{V as Z,b as X,a as ee}from"./VCard-DU3kOVDK.js";import{V as le,b as ae}from"./VBtn-azOSVwQy.js";import{V as te}from"./VDialog-Bud9f5oU.js";import{b as oe,c as ne,d as ue,e as ie,f as se,g as re,h as de,u as ce,i as ve,p as pe,j as me,k as fe,l as ge,n as ye,o as he,q as be,r as xe,s as Ve,t as ke,v as we,w as Se,x as Ce,y as Ie,z as _e,A as Pe,B as De,C as Be,D as Ae,E as Ee,F as Te,G as je,V as Fe}from"./VDataTable-BVjzQVqL.js";import{V as Re,a as ze}from"./VToolbar-oLIRM5qc.js";import{m as Ue,b as Oe,u as Me,V as Ge,f as Ne,d as He,e as $e,g as qe}from"./VInput-Bq4Ibef0.js";import{V as Le}from"./VIcon-BNrbGrm9.js";import{_ as Ke}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{V as Ye}from"./VDivider-BTbadIuc.js";import{m as We,V as Je}from"./VTextField-D66FAfNS.js";import{u as Qe,t as Ze,V as Xe,a as el,b as ll}from"./VMenu-CQCXZCaZ.js";import{V as al}from"./VAvatar-ME9kvVmU.js";import{V as tl}from"./VSpacer-DYgZJpmR.js";import"./loader-DsiMNKdA.js";import"./elevation-Dr-zzJaf.js";import"./index-CjuU1OvA.js";import"./VSlideGroup-B_Fbistk.js";/* empty css              */const ol=e({...l(),...a({variant:"text"})},"VToolbarItems"),nl=t()({name:"VToolbarItems",props:ol(),setup(e,l){let{slots:a}=l;return o({VBtn:{color:n(e,"color"),height:"inherit",variant:n(e,"variant")}}),u((()=>{var l;return i("div",{class:["v-toolbar-items",e.class],style:e.style},[null==(l=a.default)?void 0:l.call(a)])})),{}}}),ul=e({...oe(),...ne(),...ue(),...ie()},"VDataTableVirtual"),il=t()({name:"VDataTableVirtual",props:ul(),emits:{"update:modelValue":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0},setup(e,l){let{attrs:a,slots:t}=l;const{groupBy:p}=se(e),{sortBy:m,multiSort:f,mustSort:g}=re(e),{disableSort:y}=s(e),{columns:h,headers:b,filterFunctions:x,sortFunctions:V,sortRawFunctions:k}=de(e,{groupBy:p,showSelect:n(e,"showSelect"),showExpand:n(e,"showExpand")}),{items:w}=ce(e,h),S=n(e,"search"),{filteredItems:C}=ve(e,w,S,{transform:e=>e.columns,customKeyFilter:x}),{toggleSort:I}=pe({sortBy:m,multiSort:f,mustSort:g}),{sortByWithGroups:_,opened:P,extractRows:D,isGroupOpen:B,toggleGroup:A}=me({groupBy:p,sortBy:m,disableSort:y}),{sortedItems:E}=fe(e,C,_,{transform:e=>({...e.raw,...e.columns}),sortFunctions:V,sortRawFunctions:k}),{flatItems:T}=ge(E,p,P),j=r((()=>D(T.value))),{isSelected:F,select:R,selectAll:z,toggleSelect:U,someSelected:O,allSelected:M}=ye(e,{allItems:j,currentPage:j}),{isExpanded:G,toggleExpand:N}=he(e),{containerRef:H,markerRef:$,paddingTop:q,paddingBottom:L,computedItems:K,handleItemResize:Y,handleScroll:W,handleScrollend:J}=be(e,T),Q=r((()=>K.value.map((e=>e.raw))));xe({sortBy:m,page:d(1),itemsPerPage:d(-1),groupBy:p,search:S}),o({VDataTableRows:{hideNoData:n(e,"hideNoData"),noDataText:n(e,"noDataText"),loading:n(e,"loading"),loadingText:n(e,"loadingText")}});const Z=r((()=>({sortBy:m.value,toggleSort:I,someSelected:O.value,allSelected:M.value,isSelected:F,select:R,selectAll:z,toggleSelect:U,isExpanded:G,toggleExpand:N,isGroupOpen:B,toggleGroup:A,items:j.value.map((e=>e.raw)),internalItems:j.value,groupedItems:T.value,columns:h.value,headers:b.value})));u((()=>{const l=Ve.filterProps(e),o=ke.filterProps(e),n=we.filterProps(e);return i(we,v({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},n),{top:()=>{var e;return null==(e=t.top)?void 0:e.call(t,Z.value)},wrapper:()=>{var n,u,s;return i("div",{ref:H,onScrollPassive:W,onScrollend:J,class:"v-table__wrapper",style:{height:c(e.height)}},[i("table",null,[null==(n=t.colgroup)?void 0:n.call(t,Z.value),!e.hideDefaultHeader&&i("thead",{key:"thead"},[i(Ve,v(l,{sticky:e.fixedHeader}),t)]),!e.hideDefaultBody&&i("tbody",null,[i("tr",{ref:$,style:{height:c(q.value),border:0}},[i("td",{colspan:h.value.length,style:{height:0,border:0}},null)]),null==(u=t["body.prepend"])?void 0:u.call(t,Z.value),i(ke,v(a,o,{items:Q.value}),{...t,item:e=>i(Se,{key:e.internalItem.index,renderless:!0,"onUpdate:height":l=>Y(e.internalItem.index,l)},{default:l=>{var a;let{itemRef:o}=l;return(null==(a=t.item)?void 0:a.call(t,{...e,itemRef:o}))??i(Ce,v(e.props,{ref:o,key:e.internalItem.index,index:e.internalItem.index}),t)}})}),null==(s=t["body.append"])?void 0:s.call(t,Z.value),i("tr",{style:{height:c(L.value),border:0}},[i("td",{colspan:h.value.length,style:{height:0,border:0}},null)])])])])},bottom:()=>{var e;return null==(e=t.bottom)?void 0:e.call(t,Z.value)}})}))}}),sl=e({itemsLength:{type:[Number,String],required:!0},...Ie(),...oe(),..._e()},"VDataTableServer"),rl=t()({name:"VDataTableServer",props:sl(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,l){let{attrs:a,slots:t}=l;const{groupBy:d}=se(e),{sortBy:c,multiSort:f,mustSort:g}=re(e),{page:y,itemsPerPage:h}=Pe(e),{disableSort:b}=s(e),x=r((()=>parseInt(e.itemsLength,10))),{columns:V,headers:k}=de(e,{groupBy:d,showSelect:n(e,"showSelect"),showExpand:n(e,"showExpand")}),{items:w}=ce(e,V),{toggleSort:S}=pe({sortBy:c,multiSort:f,mustSort:g,page:y}),{opened:C,isGroupOpen:I,toggleGroup:_,extractRows:P}=me({groupBy:d,sortBy:c,disableSort:b}),{pageCount:D,setItemsPerPage:B}=De({page:y,itemsPerPage:h,itemsLength:x}),{flatItems:A}=ge(w,d,C),{isSelected:E,select:T,selectAll:j,toggleSelect:F,someSelected:R,allSelected:z}=ye(e,{allItems:w,currentPage:w}),{isExpanded:U,toggleExpand:O}=he(e),M=r((()=>P(w.value)));xe({page:y,itemsPerPage:h,sortBy:c,groupBy:d,search:n(e,"search")}),p("v-data-table",{toggleSort:S,sortBy:c}),o({VDataTableRows:{hideNoData:n(e,"hideNoData"),noDataText:n(e,"noDataText"),loading:n(e,"loading"),loadingText:n(e,"loadingText")}});const G=r((()=>({page:y.value,itemsPerPage:h.value,sortBy:c.value,pageCount:D.value,toggleSort:S,setItemsPerPage:B,someSelected:R.value,allSelected:z.value,isSelected:E,select:T,selectAll:j,toggleSelect:F,isExpanded:U,toggleExpand:O,isGroupOpen:I,toggleGroup:_,items:M.value.map((e=>e.raw)),internalItems:M.value,groupedItems:A.value,columns:V.value,headers:k.value})));u((()=>{const l=Be.filterProps(e),o=Ve.filterProps(e),n=ke.filterProps(e),u=we.filterProps(e);return i(we,v({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},u),{top:()=>{var e;return null==(e=t.top)?void 0:e.call(t,G.value)},default:()=>{var l,u,s,r,d,c;return t.default?t.default(G.value):i(m,null,[null==(l=t.colgroup)?void 0:l.call(t,G.value),!e.hideDefaultHeader&&i("thead",{key:"thead",class:"v-data-table__thead",role:"rowgroup"},[i(Ve,v(o,{sticky:e.fixedHeader}),t)]),null==(u=t.thead)?void 0:u.call(t,G.value),!e.hideDefaultBody&&i("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[null==(s=t["body.prepend"])?void 0:s.call(t,G.value),t.body?t.body(G.value):i(ke,v(a,n,{items:A.value}),t),null==(r=t["body.append"])?void 0:r.call(t,G.value)]),null==(d=t.tbody)?void 0:d.call(t,G.value),null==(c=t.tfoot)?void 0:c.call(t,G.value)])},bottom:()=>t.bottom?t.bottom(G.value):!e.hideDefaultFooter&&i(m,null,[i(Ye,null,null),i(Be,l,{prepend:t["footer.prepend"]})])})}))}}),dl={__name:"Confirm",props:{modelValue:{type:Boolean,required:!1},title:{type:String,required:!0,default:"提示"},text:{type:String,required:!0},confirm:{type:Function}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,t=f(!1),o=e=>{e.value=!1,n("update:modelValue",!1)},n=l;return(l,n)=>(g(),y(te,{"model-value":e.modelValue,"max-width":"400",persistent:""},{activator:h((({props:e})=>[b(l.$slots,"btn",{dialog:e})])),default:h((({isActive:l})=>[i(Z,{title:e.title,text:e.text},{default:h((()=>[i(X,null,{default:h((()=>[i(le,{color:"grey",onClick:x((e=>o(l)),["stop"])},{default:h((()=>n[0]||(n[0]=[V("取消")]))),_:2},1032,["onClick"]),i(le,{color:"primary",loading:k(t),disabled:k(t),onClick:x((e=>(async e=>{if(!a.confirm)return o(e);const l="AsyncFunction"===a.confirm.constructor.name;try{t.value=!0,l?await a.confirm():a.confirm(),o(e)}finally{t.value=!1}})(l)),["stop"])},{default:h((()=>n[1]||(n[1]=[V(" 确认 ")]))),_:2},1032,["loading","disabled","onClick"])])),_:2},1024)])),_:2},1032,["title","text"])])),_:3},8,["model-value"]))}},cl=e({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>"boolean"==typeof e||[1e3,1024].includes(+e)},...Ue({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>w(e).every((e=>null!=e&&"object"==typeof e))},...Oe({clearable:!0})},"VFileInput"),vl=t()({name:"VFileInput",inheritAttrs:!1,props:cl(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,l){function a(){var e;z.value!==document.activeElement&&(null==(e=z.value)||e.focus()),h.value||b()}function t(e){var l;null==(l=z.value)||l.click()}function o(e){c("mousedown:control",e)}function n(e){var l;null==(l=z.value)||l.click(),c("click:control",e)}function s(l){l.stopPropagation(),a(),B((()=>{y.value=[],A(e["onClick:clear"],l)}))}let{attrs:d,emit:c,slots:p}=l;const{t:g}=S(),y=C(e,"modelValue",e.modelValue,(e=>w(e)),(l=>!e.multiple&&Array.isArray(l)?l[0]:l)),{isFocused:h,focus:b,blur:x}=Me(e),V=r((()=>"boolean"!=typeof e.showSize?e.showSize:void 0)),k=r((()=>(y.value??[]).reduce(((e,l)=>{let{size:a=0}=l;return e+a}),0))),E=r((()=>I(k.value,V.value))),T=r((()=>(y.value??[]).map((l=>{const{name:a="",size:t=0}=l;return e.showSize?`${a} (${I(t,V.value)})`:a})))),j=r((()=>{var l;const a=(null==(l=y.value)?void 0:l.length)??0;return e.showSize?g(e.counterSizeString,a,E.value):g(e.counterString,a)})),F=f(),R=f(),z=f(),U=r((()=>h.value||e.active)),O=r((()=>["plain","underlined"].includes(e.variant)));return _(y,(e=>{(!Array.isArray(e)||!e.length)&&z.value&&(z.value.value="")})),u((()=>{const l=!(!p.counter&&!e.counter),u=!(!l&&!p.details),[r,c]=P(d),{modelValue:f,...g}=Ge.filterProps(e),b=Ne(e);return i(Ge,v({ref:F,modelValue:y.value,"onUpdate:modelValue":e=>y.value=e,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":O.value},e.class],style:e.style,"onClick:prepend":t},r,g,{centerAffix:!O.value,focused:h.value}),{...p,default:l=>{let{id:t,isDisabled:u,isDirty:r,isReadonly:d,isValid:f}=l;return i(He,v({ref:R,"prepend-icon":e.prependIcon,onMousedown:o,onClick:n,"onClick:clear":s,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},b,{id:t.value,active:U.value||r.value,dirty:r.value||e.dirty,disabled:u.value,focused:h.value,error:!1===f.value}),{...p,default:l=>{var t;let{props:{class:o,...n}}=l;return i(m,null,[i("input",v({ref:z,type:"file",readonly:d.value,disabled:u.value,multiple:e.multiple,name:e.name,onClick:e=>{e.stopPropagation(),d.value&&e.preventDefault(),a()},onChange:e=>{e.target&&(y.value=[...e.target.files??[]])},onFocus:a,onBlur:x},n,c),null),i("div",{class:o},[!!(null==(t=y.value)?void 0:t.length)&&!e.hideInput&&(p.selection?p.selection({fileNames:T.value,totalBytes:k.value,totalBytesReadable:E.value}):e.chips?T.value.map((e=>i(Ae,{key:e,size:"small",text:e},null))):T.value.join(", "))])])}})},details:u?a=>{var t,o;return i(m,null,[null==(t=p.details)?void 0:t.call(p,a),l&&i(m,null,[i("span",null,null),i($e,{active:!!(null==(o=y.value)?void 0:o.length),value:j.value,disabled:e.disabled},p.counter)])])}:void 0})})),D({},F,R,z)}}),pl={class:"text-center pa-4"},ml={__name:"ImportLines",setup(e){const l=E("axios"),a=d(!1);_(a,(e=>{e||(u.value=[],t.value=null)}));const t=f(null),o=[{title:"序号",key:"id",width:100},{title:"链接",key:"link",width:280},{title:"名称",key:"name",width:260},{title:"状态",key:"status",width:100},{title:"错误",key:"error"}],n=f(!1),u=f([]),s=async e=>{try{(await l.post("/webdav/manage/list",e.map((e=>(e.loading=!0,e.link))))).forEach(((l,a)=>Object.assign(e[a],l)))}catch(a){e.forEach((e=>{e.success=!1,e.error=a.message||"导入失败"}))}finally{e.forEach((e=>e.loading=!1))}},r=async()=>{if(0===u.value.length)return;n.value=!0;const e=new Set;for(let l=0;u.value.length>l;l+=5){const a=u.value.slice(l,l+5),t=s(a);e.add(t),t.finally((()=>e.delete(t))),2>e.size||await Promise.race(e)}await Promise.all(e),n.value=!1},c=async e=>{const l=e.target.files[0];if(!l)return;const a=new TextDecoder("utf-8"),t=l.stream().getReader();let{value:o,done:n}=await t.read(),i="",s=0;for(;!n;){i+=a.decode(o,{stream:!0});let e=i.split(/\r?\n/);i=e.pop();for(let l of e)l=l.trim(),l&&u.value.push({id:++s,link:l});({value:o,done:n}=await t.read())}i&&(i=i.trim(),i&&u.value.push({id:++s,link:i}))};return(e,l)=>(g(),T("div",pl,[i(te,{modelValue:k(a),"onUpdate:modelValue":l[2]||(l[2]=e=>j(a)?a.value=e:null),transition:"dialog-bottom-transition",fullscreen:""},{activator:h((({props:e})=>[i(le,v({class:"mr-2",icon:"mdi-import",density:"comfortable",variant:"text"},e),null,16)])),default:h((()=>[i(il,{class:"h-100",headers:o,items:k(u),hover:"",fixedHeader:""},{top:h((()=>[i(Re,{flat:"",density:"compact"},{default:h((()=>[i(ze,null,{default:h((()=>l[3]||(l[3]=[V("导入分享数据")]))),_:1}),i(nl,null,{default:h((()=>[i(vl,{ref_key:"inputFile",ref:t,accept:".txt",class:"d-none",onChange:c},null,512),i(le,{text:"加载文件",variant:"text",onClick:l[0]||(l[0]=e=>k(t).click()),disabled:k(n)},null,8,["disabled"]),i(le,{text:"开始任务",variant:"text",onClick:r,loading:k(n)},null,8,["loading"])])),_:1}),i(le,{icon:"mdi-close",onClick:l[1]||(l[1]=e=>a.value=!1),disabled:k(n)},null,8,["disabled"])])),_:1})])),"item.status":h((({item:e})=>[e.loading?(g(),y(ae,{key:0,size:18,width:2,color:"green",indeterminate:""})):e.success?(g(),y(Le,{key:1,icon:"mdi-check",color:"green"})):!1===e.success?(g(),y(Le,{key:2,icon:"mdi-close",color:"red"})):(g(),y(Le,{key:3,icon:"mdi-help",color:"grey"}))])),_:1},8,["items"])])),_:1},8,["modelValue"])]))}},fl=e({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...ie({filterKeys:["title"]}),...Ee({hideNoData:!0,returnObject:!0}),...F(We({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...R({transition:!1})},"VCombobox"),gl=t()({name:"VCombobox",props:fl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,l){function a(l){K=!0,e.openOnClear&&(q.value=!0)}function t(){me.value||(q.value=!0)}function o(e){me.value||(E.value&&(e.preventDefault(),e.stopPropagation()),q.value=!q.value)}function n(e){var l;N(e)&&(null==(l=A.value)||l.focus())}function s(l){var a;if(H(l)||e.readonly||(null==ae?void 0:ae.isReadonly.value))return;const t=A.value.selectionStart,o=le.value.length;if((L.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(q.value=!0),["Escape"].includes(l.key)&&(q.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(pe.value&&["Enter","Tab"].includes(l.key)&&!le.value.some((e=>{let{value:l}=e;return l===de.value[0].value}))&&g(se.value[0]),T.value=!0),"ArrowDown"===l.key&&pe.value&&(null==(a=fe.value)||a.focus("next")),"Enter"===l.key&&ue.value&&(g(Ze(e,ue.value)),oe.value&&(ne.value="")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&oe.value&&le.value.length>0&&!ue.value)return g(le.value[0],!1);if(~L.value){const e=L.value;g(le.value[L.value],!1),L.value=o-1>e?e:o-2}else"Backspace"!==l.key||ue.value||(L.value=o-1)}if(e.multiple){if("ArrowLeft"===l.key){if(0>L.value&&t>0)return;const e=L.value>-1?L.value-1:o-1;le.value[e]?L.value=e:(L.value=-1,A.value.setSelectionRange(ue.value.length,ue.value.length))}if("ArrowRight"===l.key){if(0>L.value)return;const e=L.value+1;le.value[e]?L.value=e:(L.value=-1,A.value.setSelectionRange(0,0))}}}function c(){var l;e.eager&&(null==(l=R.value)||l.calculateVisibleItems())}function p(){var e;E.value&&(T.value=!0,null==(e=A.value)||e.focus())}function g(l){let a=1>=arguments.length||void 0===arguments[1]||arguments[1];if(l&&!l.props.disabled)if(e.multiple){const t=le.value.findIndex((a=>e.valueComparator(a.value,l.value))),o=null==a?!~t:a;if(~t){const e=o?[...le.value,l]:[...le.value];e.splice(t,1),le.value=e}else o&&(le.value=[...le.value,l]);e.clearOnSelect&&(ue.value="")}else{const e=!1!==a;le.value=e?[l]:[],ne.value=e&&!oe.value?l.title:"",B((()=>{q.value=!1,T.value=!0}))}}function y(e){E.value=!0,setTimeout((()=>{j.value=!0}))}function h(e){j.value=!1}function b(l){null!=l&&(""!==l||e.multiple||oe.value)||(le.value=[])}var x;let{emit:k,slots:I}=l;const{t:P}=S(),A=f(),E=d(!1),T=d(!0),j=d(!1),F=f(),R=f(),$=C(e,"menu"),q=r({get:()=>$.value,set:e=>{var l;$.value&&!e&&(null==(l=F.value)?void 0:l.ΨopenChildren.size)||($.value=e)}}),L=d(-1);let K=!1;const Y=r((()=>{var e;return null==(e=A.value)?void 0:e.color})),W=r((()=>q.value?e.closeText:e.openText)),{items:J,transformIn:Q,transformOut:Z}=Qe(e),{textColorClasses:X,textColorStyles:ee}=z(Y),le=C(e,"modelValue",[],(e=>Q(w(e))),(l=>{const a=Z(l);return e.multiple?a:a[0]??null})),ae=qe(),te=r((()=>!(!e.chips&&!I.chip))),oe=r((()=>te.value||!!I.selection)),ne=d(e.multiple||oe.value?"":(null==(x=le.value[0])?void 0:x.title)??""),ue=r({get:()=>ne.value,set:l=>{var a;if(ne.value=l??"",e.multiple||oe.value||(le.value=[Ze(e,l)]),l&&e.multiple&&(null==(a=e.delimiters)?void 0:a.length)){const a=l.split(RegExp(`(?:${e.delimiters.join("|")})+`));a.length>1&&(a.forEach((l=>{(l=l.trim())&&g(Ze(e,l))})),ne.value="")}l||(L.value=-1),T.value=!l}}),ie=r((()=>"function"==typeof e.counterValue?e.counterValue(le.value):"number"==typeof e.counterValue?e.counterValue:e.multiple?le.value.length:ue.value.length));_(ne,(e=>{K?B((()=>K=!1)):E.value&&!q.value&&(q.value=!0),k("update:search",e)})),_(le,(l=>{var a;e.multiple||oe.value||(ne.value=(null==(a=l[0])?void 0:a.title)??"")}));const{filteredItems:se,getMatches:re}=ve(e,J,(()=>T.value?"":ue.value)),de=r((()=>e.hideSelected?se.value.filter((e=>!le.value.some((l=>l.value===e.value)))):se.value)),ce=r((()=>le.value.map((e=>e.value)))),pe=r((()=>{var l;return(!0===e.autoSelectFirst||"exact"===e.autoSelectFirst&&ue.value===(null==(l=de.value[0])?void 0:l.title))&&de.value.length>0&&!T.value&&!j.value})),me=r((()=>e.hideNoData&&!de.value.length||e.readonly||(null==ae?void 0:ae.isReadonly.value))),fe=f(),ge=Te(fe,A);return _(E,((l,a)=>{if(!l&&l!==a&&(L.value=-1,q.value=!1,ue.value)){if(e.multiple)return void g(Ze(e,ue.value));if(!oe.value)return;le.value.some((e=>{let{title:l}=e;return l===ue.value}))?ne.value="":g(Ze(e,ue.value))}})),_(q,(()=>{if(!e.hideSelected&&q.value&&le.value.length){const l=de.value.findIndex((l=>le.value.some((a=>e.valueComparator(a.value,l.value)))));U&&window.requestAnimationFrame((()=>{var e;l>=0&&(null==(e=R.value)||e.scrollToIndex(l))}))}})),_((()=>e.items),((e,l)=>{q.value||E.value&&!l.length&&e.length&&(q.value=!0)})),u((()=>{const l=!!(!e.hideNoData||de.value.length||I["prepend-item"]||I["append-item"]||I["no-data"]),u=le.value.length>0,r=Je.filterProps(e);return i(Je,v({ref:A},r,{modelValue:ue.value,"onUpdate:modelValue":[e=>ue.value=e,b],focused:E.value,"onUpdate:focused":e=>E.value=e,validationValue:le.externalValue,counterValue:ie.value,dirty:u,class:["v-combobox",{"v-combobox--active-menu":q.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!oe.value,"v-combobox--selecting-index":L.value>-1,["v-combobox--"+(e.multiple?"multiple":"single")]:!0},e.class],style:e.style,readonly:e.readonly,placeholder:u?void 0:e.placeholder,"onClick:clear":a,"onMousedown:control":t,onKeydown:s}),{...I,default:()=>i(m,null,[i(Xe,v({ref:F,modelValue:q.value,"onUpdate:modelValue":e=>q.value=e,activator:"parent",contentClass:"v-combobox__content",disabled:me.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:c,onAfterLeave:p},e.menuProps),{default:()=>[l&&i(el,v({ref:fe,selected:ce.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),onKeydown:n,onFocusin:y,onFocusout:h,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},ge,e.listProps),{default:()=>{var l,a,t;return[null==(l=I["prepend-item"])?void 0:l.call(I),!de.value.length&&!e.hideNoData&&((null==(a=I["no-data"])?void 0:a.call(I))??i(ll,{title:P(e.noDataText)},null)),i(je,{ref:R,renderless:!0,items:de.value},{default:l=>{var a;let{item:t,index:o,itemRef:n}=l;const u=v(t.props,{ref:n,key:o,active:!(!pe.value||0!==o)||void 0,onClick:()=>g(t,null)});return(null==(a=I.item)?void 0:a.call(I,{item:t,index:o,props:u}))??i(ll,v(u,{role:"option"}),{prepend:l=>{let{isSelected:a}=l;return i(m,null,[e.multiple&&!e.hideSelected?i(Fe,{key:t.value,modelValue:a,ripple:!1,tabindex:"-1"},null):void 0,t.props.prependAvatar&&i(al,{image:t.props.prependAvatar},null),t.props.prependIcon&&i(Le,{icon:t.props.prependIcon},null)])},title:()=>{var e,l;return T.value?t.title:function(e,l,a){if(null==l)return e;if(Array.isArray(l))throw Error("Multiple matches is not implemented");return"number"==typeof l&&~l?i(m,null,[i("span",{class:"v-combobox__unmask"},[e.substr(0,l)]),i("span",{class:"v-combobox__mask"},[e.substr(l,a)]),i("span",{class:"v-combobox__unmask"},[e.substr(l+a)])]):e}(t.title,null==(e=re(t))?void 0:e.title,(null==(l=ue.value)?void 0:l.length)??0)}})}}),null==(t=I["append-item"])?void 0:t.call(I)]}})]}),le.value.map(((l,a)=>{function t(e){e.stopPropagation(),e.preventDefault(),g(l,!1)}const o={"onClick:close":t,onKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),t(e))},onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},n=te.value?!!I.chip:!!I.selection,u=n?O(te.value?I.chip({item:l,index:a,props:o}):I.selection({item:l,index:a})):void 0;if(!n||u)return i("div",{key:l.value,class:["v-combobox__selection",a===L.value&&["v-combobox__selection--selected",X.value]],style:a===L.value?ee.value:{}},[te.value?I.chip?i(M,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:l.title}}},{default:()=>[u]}):i(Ae,v({key:"chip",closable:e.closableChips,size:"small",text:l.title,disabled:l.props.disabled},o),null):u??i("span",{class:"v-combobox__selection-text"},[l.title,e.multiple&&le.value.length-1>a&&i("span",{class:"v-combobox__selection-comma"},[V(",")])])])}))]),"append-inner":function(){for(var l,a=arguments.length,t=Array(a),n=0;a>n;n++)t[n]=arguments[n];return i(m,null,[null==(l=I["append-inner"])?void 0:l.call(I,...t),e.hideNoData&&!e.items.length||!e.menuIcon?void 0:i(Le,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:o,onClick:G,"aria-label":P(W.value),title:P(W.value),tabindex:"-1"},null)])}})})),D({isFocused:E,isPristine:T,menu:q,search:ue,selectionIndex:L,filteredItems:se,select:g},A)}}),yl=e({modelValue:null,color:String,cancelText:{type:String,default:"$vuetify.confirmEdit.cancel"},okText:{type:String,default:"$vuetify.confirmEdit.ok"}},"VConfirmEdit"),hl=t()({name:"VConfirmEdit",props:yl(),emits:{cancel:()=>!0,save:e=>!0,"update:modelValue":e=>!0},setup(e,l){function a(){s.value=d.value,o("save",d.value)}function t(){d.value=structuredClone(q(s.value)),o("cancel")}let{emit:o,slots:n}=l;const s=C(e,"modelValue"),d=f();$((()=>{d.value=structuredClone(q(s.value))}));const{t:c}=S(),v=r((()=>L(s.value,d.value)));let p=!1;return u((()=>{var l;const o=i(m,null,[i(le,{disabled:v.value,variant:"text",color:e.color,onClick:t,text:c(e.cancelText)},null),i(le,{disabled:v.value,variant:"text",color:e.color,onClick:a,text:c(e.okText)},null)]);return i(m,null,[null==(l=n.default)?void 0:l.call(n,{model:d,save:a,cancel:t,isPristine:v.value,get actions(){return p=!0,o}}),!p&&o])})),{save:a,cancel:t,isPristine:v}}}),bl={class:"container"},xl={class:"d-sm-flex"},Vl="/webdav/manage/list",kl=Ke({__name:"webdav",setup(e){const l=E("axios"),a=f({page:1,itemsPerPage:25,type:"",kw:""}),t=[{title:"名称",key:"name",sortable:!1},{title:"网盘类型",key:"type",width:100,sortable:!1},{title:"更新时间",key:"updatedAt",width:180,align:"center",sortable:!1},{title:"操作",key:"actions",align:"end",sortable:!1,width:"80px"}],o=f([]),n=f({items:[],total:0}),u=f(!1),s=async e=>{u.value=!0;try{n.value=await l.get(Vl,{params:Object.assign({},e,a.value)})}catch{}finally{u.value=!1}},r=async()=>{u.value=!0;try{await l.delete(Vl,{data:{ids:o.value}}),o.value=[],await s(a.value)}catch{}finally{u.value=!1}},d=async()=>{u.value=!0;try{await l.put(Vl,m.value),await s(a.value),c.value=!1}catch(e){edit.msg=e.message||"修改失败，请稍后再试"}finally{u.value=!1}},c=f(!1),p=f(null),m=f({}),b=f(null);return(e,l)=>{const f=ml,w=dl;return g(),T("div",bl,[i(rl,{class:"h-100",page:k(a).page,"onUpdate:page":l[6]||(l[6]=e=>k(a).page=e),"items-per-page":k(a).itemsPerPage,"onUpdate:itemsPerPage":l[7]||(l[7]=e=>k(a).itemsPerPage=e),headers:t,items:k(n).items,"items-length":k(n).total,loading:k(u),"onUpdate:options":s,hover:"",fixedHeader:"",fixedFooter:"",hideDefaultHeader:!1,"show-select":"",modelValue:k(o),"onUpdate:modelValue":l[8]||(l[8]=e=>j(o)?o.value=e:null)},{top:h((()=>[i(Re,{class:"pl-4 pr-4",flat:"",density:"compact"},{default:h((()=>[i(Le,{icon:"mdi-list-box"}),K("div",xl,[i(Je,{width:"200",class:"ml-2",modelValue:k(a).kw,"onUpdate:modelValue":l[0]||(l[0]=e=>k(a).kw=e),modelModifiers:{lazy:!0},density:"compact",label:"关键词","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":"","onClick:prependInner":l[1]||(l[1]=e=>s(k(a))),onKeydown:l[2]||(l[2]=Y((e=>s(k(a))),["enter"]))},null,8,["modelValue"]),i(gl,{width:"110",class:"ml-2",modelValue:k(a).type,"onUpdate:modelValue":l[3]||(l[3]=e=>k(a).type=e),density:"compact",label:"类型",items:["baidu","a189","a115","uc","quark","a123"],variant:"solo-filled",flat:"","hide-details":"","single-line":""},null,8,["modelValue"])]),i(le,{class:"ml-2",icon:"mdi-magnify",density:"comfortable",variant:"text",onClick:l[4]||(l[4]=x((e=>s(k(a))),["stop"]))}),i(tl),i(f),i(w,{title:"警告",text:"此操作不可逆！",confirm:r},{btn:h((({dialog:e})=>[i(le,v({class:"mr-2",icon:"mdi-delete",density:"comfortable",variant:"text",disabled:!k(o).length||k(u)},e),null,16,["disabled"])])),_:1})])),_:1})])),"item.updatedAt":h((({item:e})=>[V(W(e.updatedAt?k(J)(e.updatedAt).format("YYYY-MM-DD HH:mm:ss"):""),1)])),"item.actions":h((({item:e})=>[i(le,{icon:"mdi-pencil",density:"comfortable",size:"small",variant:"text",onClick:l=>m.value=e,onMouseenter:l[5]||(l[5]=e=>p.value=e.currentTarget)},null,8,["onClick"])])),_:1},8,["page","items-per-page","items","items-length","loading","modelValue"]),i(te,{modelValue:k(c),"onUpdate:modelValue":l[11]||(l[11]=e=>j(c)?c.value=e:null),activator:k(p),"max-width":"500"},{default:h((()=>[i(hl,{modelValue:k(m),"onUpdate:modelValue":l[9]||(l[9]=e=>j(m)?m.value=e:null),"cancel-text":"取消","ok-text":"更新",onCancel:l[10]||(l[10]=e=>c.value=!1),onSave:d},{default:h((({model:e,actions:l})=>[i(Z,{title:"修改目录名称"},{actions:h((()=>[i(tl),(g(),y(Q(l)))])),default:h((()=>[i(ee,null,{default:h((()=>[i(Je,{modelValue:e.value.name,"onUpdate:modelValue":l=>e.value.name=l,variant:"underlined",rules:[e=>!!e||"名称不能为空"],"error-messages":k(b),error:!!k(b)},null,8,["modelValue","onUpdate:modelValue","rules","error-messages","error"])])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1},8,["modelValue","activator"])])}}},[["__scopeId","data-v-cc855ae0"]]);export{kl as default};
